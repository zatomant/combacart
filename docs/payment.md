# Оплата Замовлень #

Посилання на оплату формується на кожне замовлення, або на групу замовлень якщо ввимкнено розділенн Замовлень за Продавцями.

## Змінні та події ##
Entity::get('PAGE_PAYMENT')  
Entity::get('PAGE_PAYMENT_CALLBACK')  
modx event OnPageNotFound


## Сторінка оплати ##
Сторінка оплати може бути показана двома способами:    
1. Через посилання **site/PAGE_TRACKING?ідентифікатор_замовлення** та спрацювання плагіну на event OnPageNotFound 
   У цьому випадку буде використано шаблон pagefull_payment пакету \Bundle\Payment.  
   Префікс **PAGE_PAYMENT** береться з налаштувань і може бути перевизначен за потреби.

2. Виклик сніпету [!CombaFunctions? &fnct=`OrderPay` &uid=`ідентифікатор_замовлення`!] або [!CombaFunctions? &fnct=`OrderPay`!] у вашій сторінці
   У цьому випадку буде додано розмітку payment пакету \Bundle\Payment до вашого шаблону.  
   У разі відсутності параметра uid, буде використано пошук ідентифікатора замовлення з адресного рядка.    
  
За замовчувнням, використовується перший варіант.

## Онлайн оплата ##

До кожного Продавця можна додати онлайн оплату з переліку доступних серверів онлайн оплат.  
Зареєструйтесь на одному з доступних сервисів та внесіть API ключ до CombaCart.  
Наразі CombaCart має підтримку Liqpay та monobank.

### callback для онлайн оплати ###

PaymentCallback клас для обробки callback від серверів онлайн оплати.  
Префікс **PAGE_PAYMENT_CALLBACK** береться з налаштувань і може бути перевизначен за потреби.